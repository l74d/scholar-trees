(S (NP (DT This) (NN study)) (VP (VBZ develops) (NP (NP (DT an) (JJ unsupervised) (NN learning) (NN algorithm)) (PP (IN for) (NP (NP (NNS products)) (PP (IN of) (NP (NP (JJ expert) (NNS capsules)) (PP (IN with) (NP (JJ dynamic) (NN routing))))))))) (. .))
(S (S (ADJP (JJ Analogous) (PP (TO to) (NP (NP (JJ binary-valued) (NNS neurons)) (PP (IN in) (NP (NNP Restricted) (NNP Boltzmann) (NNP Machines))))))) (, ,) (NP (NP (DT the) (NN magnitude)) (PP (IN of) (NP (DT a) (JJ squashed) (NN capsule) (VBG firing)))) (VP (VBZ takes) (NP (NP (NNS values)) (PP (IN between) (NP (NN zero) (CC and) (CD one)))) (, ,) (S (VP (VBG representing) (NP (NP (DT the) (NN probability)) (PP (IN of) (S (NP (DT the) (NN capsule)) (VP (VBG being) (ADVP (IN on))))))))) (. .))
(S (NP (DT This) (NN analogy)) (VP (VBZ motivates) (NP (NP (DT the) (NN design)) (PP (IN of) (NP (NP (DT an) (NN energy) (NN function)) (PP (IN for) (NP (NN capsule) (NNS networks))))))) (. .))
(S (SBAR (IN In) (NN order) (S (VP (TO to) (VP (VB have) (NP (NP (DT an) (JJ efficient) (NN sampling) (NN procedure)) (SBAR (WHADVP (WRB where)) (S (NP (NN hidden) (NN layer) (NNS nodes)) (VP (VBP are) (RB not) (VP (VBN connected)))))))))) (, ,) (S (NP (DT the) (NN energy) (NN function)) (VP (VBZ is) (VP (VBN made) (S (ADJP (JJ consistent) (PP (IN with) (NP (JJ dynamic) (NN routing))) (PP (IN in) (NP (NP (DT the) (NN sense)) (PP (IN of) (NP (NP (DT the) (NN probability)) (PP (IN of) (NP (DT a) (NN capsule) (NN firing)))))))))))) (, ,) (CC and) (S (NP (NP (NN inference)) (PP (IN on) (NP (DT the) (NN capsule) (NN network)))) (VP (VBZ is) (VP (VBN computed) (PP (IN with) (NP (DT the) (JJ dynamic) (NN routing) (PP (IN between) (NP (NNS capsules))) (NN procedure)))))) (. .))
(S (SBAR (IN In) (NN order) (S (VP (TO to) (VP (VB optimize) (NP (NP (DT the) (NN log-likelihood)) (PP (IN of) (NP (DT the) (JJ visible) (NN layer) (NNS capsules)))))))) (, ,) (NP (DT the) (NN gradient)) (VP (VBZ is) (VP (VBN found) (PP (IN in) (NP (NP (NNS terms)) (PP (IN of) (NP (DT this) (NN energy) (NN function))))))) (. .))
(S (NP (DT The) (NN developed) (VBD unsupervised) (VBG learning) (NN algorithm)) (VP (VP (VBZ is) (VP (VBN used) (S (VP (TO to) (VP (VB train) (NP (DT a) (NN capsule) (NN network)) (PP (IN on) (NP (JJ standard) (NN vision) (NNS datasets)))))))) (, ,) (CC and) (VP (VBZ is) (ADJP (JJ able) (S (VP (TO to) (VP (VB generate) (NP (ADJP (JJ realistic) (VBG looking)) (NNS images)) (PP (IN from) (NP (PRP$ its) (VBN learned) (NN distribution))))))))) (. .))
