(S (S (VP (VBG Forecasting) (NP (NP (DT the) (NN flow)) (PP (IN of) (NP (NN crowds)))))) (VP (VBZ is) (UCP (PP (IN of) (NP (NP (JJ great) (NN importance)) (PP (TO to) (NP (NP (NN traffic) (NN management)) (CC and) (NP (JJ public) (NN safety)))))) (, ,) (CC yet) (NP (NP (DT a) (ADJP (RB very) (JJ challenging)) (NN task)) (VP (VBN affected) (PP (IN by) (NP (NP (JJ many) (JJ complex) (NNS factors)) (, ,) (PP (JJ such) (IN as) (NP (NP (NN inter-region) (NN traffic)) (, ,) (NP (NNS events)) (CC and) (NP (NN weather)))))))))) (. .))
(S (PP (IN In) (NP (DT this) (NN paper))) (, ,) (NP (PRP we)) (VP (VBP propose) (NP (NP (DT a) (JJ deep-learning-based) (NN approach)) (, ,) (VP (VBD called) (S (NP (NNP ST-ResNet)))) (, ,) (SBAR (S (VP (TO to) (ADVP (RB collectively)) (VP (VB forecast) (NP (NP (DT the) (JJ in-flow) (CC and) (JJ out-flow)) (PP (IN of) (NP (NN crowds))) (PP (IN in) (NP (NP (ADJP (DT each) (CC and) (DT every)) (NN region)) (PP (IN through) (NP (DT a) (NN city)))))))))))) (. .))
(S (NP (PRP We)) (VP (VBP design) (NP (NP (NP (DT an) (JJ end-to-end) (NN structure)) (PP (IN of) (NP (NNP ST-ResNet)))) (PP (VBN based) (PP (IN on) (NP (NP (JJ unique) (NNS properties)) (PP (IN of) (NP (JJ spatio-temporal) (NNS data)))))))) (. .))
(S (ADVP (RBR More) (RB specifically)) (, ,) (NP (PRP we)) (VP (VBP employ) (NP (NP (DT the) (NN framework)) (PP (IN of) (NP (DT the) (JJ residual) (JJ neural) (NNS networks)))) (S (VP (TO to) (VP (VB model) (NP (NP (DT the) (JJ temporal) (NX (NN closeness)) (, ,) (NX (NN period)) (, ,) (CC and) (NN trend) (NNS properties)) (PP (IN of) (NP (DT the) (NN crowd) (NN traffic))) (, ,) (ADVP (RB respectively))))))) (. .))
(S (PP (IN For) (NP (DT each) (NN property))) (, ,) (NP (PRP we)) (VP (VBP design) (NP (NP (DT a) (NN branch)) (PP (IN of) (NP (JJ residual) (JJ convolutional) (NNS units))) (, ,) (SBAR (WHNP (NP (DT each)) (WHPP (IN of) (WHNP (WDT which)))) (S (VP (NNS models) (NP (NP (DT the) (JJ spatial) (NNS properties)) (PP (IN of) (NP (DT the) (NN crowd) (NN traffic))))))))) (. .))
(S (NP (JJ ST-ResNet)) (VP (NNS learns) (S (VP (TO to) (ADVP (RB dynamically)) (VB aggregate) (NP (NP (DT the) (NN output)) (PP (IN of) (NP (DT the) (CD three) (JJ residual) (JJ neural) (NNS networks)))) (PP (VBN based) (PP (IN on) (NP (NNS data)))) (, ,) (S (VP (VBG assigning) (NP (JJ different) (NNS weights)) (PP (TO to) (NP (JJ different) (NNS branches) (CC and) (NNS regions)))))))) (. .))
(S (NP (DT The) (NN aggregation)) (VP (VBZ is) (ADVP (JJ further)) (VP (VBN combined) (PP (IN with) (NP (NP (JJ external) (NNS factors)) (, ,) (PP (JJ such) (IN as) (NP (NP (NN weather)) (CC and) (NP (NP (NN day)) (PP (IN of) (NP (DT the) (NN week)))))))) (, ,) (S (VP (TO to) (VP (VB predict) (NP (NP (DT the) (JJ final) (NN traffic)) (PP (IN of) (NP (NN crowds))) (PP (IN in) (NP (ADJP (DT each) (CC and) (DT every)) (NN region))))))))) (. .))
(S (NP (PRP We)) (VP (VBP evaluate) (NP (JJ ST-ResNet)) (PP (VBN based) (PP (IN on) (NP (NP (CD two) (NNS types)) (PP (IN of) (NP (NN crowd) (NNS flows))) (PP (IN in) (NP (NNP Beijing) (CC and) (NNP NYC)))))) (, ,) (S (VP (VBG finding) (SBAR (IN that) (S (NP (PRP$ its) (NN performance)) (VP (NNS exceeds) (NP (CD six) (JJ well-know) (NNS methods)))))))) (. .))
