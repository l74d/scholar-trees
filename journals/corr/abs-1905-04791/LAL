(S (NP (NNP Computational) (NN color) (NN constancy)) (VP (VP (NNS refers) (PP (TO to) (NP (NP (DT the) (NN estimation)) (PP (IN of) (NP (DT the) (NN scene) (NN illumination)))))) (CC and) (VP (VBZ makes) (S (NP (DT the) (JJ perceived) (NN color)) (ADJP (RB relatively) (JJ stable) (PP (IN under) (NP (VBG varying) (NN illumination))))))) (. .))
(S (PP (IN In) (NP (DT the) (JJ past) (JJ few) (NNS years))) (, ,) (NP (NP (JJ deep) (NNP Convolutional) (NNP Neural) (NNP Networks)) (PRN (-LRB- -LRB-) (NP (NNP CNNs)) (-RRB- -RRB-))) (VP (VBP have) (VP (VBN delivered) (NP (NP (JJ superior) (NN performance)) (PP (IN in) (NP (JJ illuminant) (NN estimation)))))) (. .))
(S (NP (JJ Several) (JJ representative) (NNS methods)) (VP (VBP formulate) (NP (PRP it)) (PP (IN as) (NP (DT a) (JJ multi-label) (NN prediction) (NN problem))) (PP (IN by) (S (VP (VBG learning) (NP (NP (DT the) (JJ local) (NN appearance)) (PP (IN of) (NP (NN image) (NNS patches)))) (S (VP (VBG using) (NP (NNP CNNs)))))))) (. .))
(S (ADVP (RB However)) (, ,) (NP (DT these) (NNS approaches)) (ADVP (RB inevitably)) (VP (VBP make) (NP (NP (JJ incorrect) (NNS estimations)) (PP (IN for) (NP (NP (DT the) (JJ ambiguous) (NNS patches)) (VP (VBN affected) (PP (IN by) (NP (PRP$ their) (NN neighborhood) (NN contexts)))))))) (. .))
(S (NP (NNP Inaccurate) (JJ local) (NNS estimates)) (VP (VBP are) (ADJP (JJ likely) (S (VP (TO to) (VP (VB bring) (PRT (IN in)) (NP (JJ degraded) (NN performance)))))) (SBAR (WHADVP (WRB when)) (S (VP (VBG combining) (PP (IN into) (NP (DT a) (JJ global) (NN prediction))))))) (. .))
(S (S (VP (TO To) (VP (VB address) (NP (DT the) (JJ above) (NNS issues))))) (, ,) (NP (PRP we)) (VP (VBP propose) (NP (NP (DT a) (JJ contextual) (NN deep) (NN network)) (PP (IN for) (NP (JJ patch-based) (JJ illuminant) (NN estimation))) (VP (VBD equipped) (PP (IN with) (NP (NN refinement)))))) (. .))
(S (ADVP (RB First)) (, ,) (NP (NP (DT the) (JJ contextual) (NN net)) (PP (IN with) (NP (DT a) (JJ center-surround) (NN architecture)))) (VP (VP (VBZ extracts) (NP (JJ local) (JJ contextual) (NNS features)) (PP (IN from) (NP (NN image) (NNS patches)))) (, ,) (CC and) (VP (VBZ generates) (NP (NP (JJ initial) (NN illuminant) (NNS estimates)) (CC and) (NP (DT the) (JJ corresponding) (NN color) (VBD corrected) (NNS patches))))) (. .))
(S (NP (DT The) (NNS patches)) (VP (VBP are) (VP (VBN sampled) (PP (VBN based) (PP (IN on) (NP (DT the) (NN observation) (SBAR (IN that) (S (NP (NP (NNS pixels)) (PP (IN with) (NP (JJ large) (NN color) (NNS differences)))) (VP (VBP describe) (NP (DT the) (NN illumination)) (ADVP (RB well)))))))))) (. .))
(S (ADVP (RB Then)) (, ,) (NP (DT the) (JJ refinement) (NN net)) (VP (VBZ integrates) (NP (DT the) (NN input) (NNS patches)) (PP (IN with) (NP (DT the) (VBN corrected) (NNS patches))) (PP (IN in) (NP (NP (NN conjunction)) (PP (IN with) (NP (NP (DT the) (NN use)) (PP (IN of) (NP (JJ intermediate) (NNS features))) (S (VP (TO to) (VP (VB improve) (NP (DT the) (NN performance)))))))))) (. .))
(S (S (VP (TO To) (VP (VB train) (NP (PDT such) (DT a) (NN network)) (PP (IN with) (NP (JJ numerous) (NNS parameters)))))) (, ,) (NP (PRP we)) (VP (VBP propose) (NP (NP (DT a) (JJ stage-wise) (NN training) (NN strategy)) (, ,) (SBAR (WHPP (IN in) (WHNP (WDT which))) (S (NP (NP (NP (DT the) (NNS features)) (CC and) (NP (DT the) (VBN predicted) (NN illuminant))) (PP (IN from) (NP (JJ previous) (NNS stages)))) (VP (VBP are) (VP (VBN provided) (PP (TO to) (NP (DT the) (JJ next) (NN learning) (NN stage))) (SBAR (IN with) (S (NP (ADJP (RBR more) (NN finer)) (NNS estimates)) (VP (VBD recovered)))))))))) (. .))
(S (NP (NNS Experiments)) (VP (VBP show) (SBAR (IN that) (S (NP (PRP$ our) (NN approach)) (VP (VBZ obtains) (NP (NP (JJ competitive) (NN performance)) (PP (IN on) (NP (CD two) (JJ illuminant) (NN estimation) (NNS benchmarks)))))))) (. .))
