(S (NP (JJ Modern) (NN retrieval) (NNS problems)) (VP (VBP are) (VP (VBN characterised) (PP (IN by) (NP (NP (NP (NP (NN training) (NNS sets)) (PP (IN with) (NP (NP (ADVP (RB potentially)) (NP (NNS billions)) (PP (IN of) (NP (NNS labels)))) (, ,) (CC and) (NP (NP (JJ heterogeneous) (NNS data) (NNS distributions)) (PP (IN across) (NP (NNS subpopulations))))))) (-LRB- -LRB-) (S (NP (NP (ADVP (FW e.g.)) (, ,) (NNS users)) (PP (IN of) (NP (DT a) (NN retrieval) (NN system)))) (VP (MD may) (VP (VB be) (PP (IN from) (NP (JJ different) (NNS countries)))))) (-RRB- -RRB-)) (, ,) (SBAR (WHNP (NP (DT each)) (WHPP (IN of) (WHNP (WDT which)))) (S (VP (VBZ poses) (NP (DT a) (NN challenge))))))))) (. .))
(FRAG (NP (NP (DT The) (JJ first) (NN challenge) (NNS concerns)) (NP (NN scalability))) (: :) (S (PP (IN with) (NP (NP (DT a) (JJ large) (NN number)) (PP (IN of) (NP (NNS labels))))) (, ,) (NP (JJ standard) (NNS losses)) (VP (VBP are) (ADJP (JJ difficult) (S (VP (TO to) (VP (VB optimise) (ADVP (RB even)) (PP (IN on) (NP (DT a) (JJ single) (NN example))))))))) (. .))
(S (NP (NP (DT The) (JJ second) (NN challenge) (NNS concerns)) (NP (NN uniformity) (: :) (CD one))) (ADVP (RB ideally)) (VP (VBZ wants) (NP (JJ good) (NN performance)) (PP (IN on) (NP (DT each) (NN subpopulation)))) (. .))
(S (SBAR (IN While) (S (NP (JJ several) (NNS solutions)) (VP (VBP have) (VP (VBN been) (VP (VBN proposed) (S (VP (TO to) (VP (VB address) (NP (DT the) (JJ first) (NN challenge)))))))))) (, ,) (NP (DT the) (JJ second) (NN challenge)) (VP (VBZ has) (VP (VBN received) (NP (ADJP (RB relatively) (JJR less)) (NN attention)))) (. .))
(S (PP (IN In) (NP (DT this) (NN paper))) (, ,) (NP (PRP we)) (VP (VBP propose) (NP (NP (NP (RB doubly) (HYPH -) (JJ stochastic) (NN mining)) (-LRB- -LRB-) (NP (NN S2M)) (-RRB- -RRB-)) (, ,) (NP (NP (DT a) (JJ stochastic) (NN optimization) (NN technique)) (SBAR (WHNP (WDT that)) (S (VP (VBZ addresses) (NP (DT both) (NNS challenges)))))))) (. .))
(S (PP (IN In) (NP (NP (DT each) (NN iteration)) (PP (IN of) (NP (NN S2M))))) (, ,) (NP (PRP we)) (VP (VP (VBP compute) (NP (DT a) (NML (PP (IN per) (HYPH -) (NP (NN example)))) (NN loss)) (PP (VBN based) (PP (IN on) (NP (NP (DT a) (NN subset)) (PP (IN of) (NP (JJS hardest) (NNS labels))))))) (, ,) (CC and) (ADVP (RB then)) (VP (VB compute) (NP (DT the) (NN minibatch) (NN loss)) (PP (VBN based) (PP (IN on) (NP (DT the) (JJS hardest) (NNS examples)))))) (. .))
(S (NP (PRP We)) (VP (VBP show) (SBAR (ADVP (ADVP (RB theoretically)) (CC and) (ADVP (RB empirically))) (IN that) (S (PP (IN by) (S (VP (VBG focusing) (PP (IN on) (NP (DT the) (JJS hardest) (NNS examples)))))) (, ,) (NP (NN S2M)) (VP (VBZ ensures) (SBAR (IN that) (S (NP (DT all) (NNS data) (NNS subpopulations)) (VP (VBP are) (VP (VBN modelled) (ADVP (RB well)))))))))) (. .))
