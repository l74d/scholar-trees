(S (S (VP (VBG Optimising) (NP (DT a) (ADJP (NP (NN ranking)) (HYPH -) (VBN based)) (JJ metric)))) (, ,) (PP (JJ such) (PP (IN as) (NP (JJ Average) (NNP Precision)) (PRN (-LRB- -LRB-) (NP (NN AP)) (-RRB- -RRB-)))) (, ,) (VP (VP (VBZ is) (ADVP (RB notoriously)) (VP (VBG challenging) (PP (IN due) (PP (IN to) (NP (DT the) (NN fact)))) (SBAR (IN that) (S (NP (PRP it)) (VP (VBZ is) (ADJP (JJ non-differentiable))))))) (, ,) (CC and) (ADVP (RB hence)) (VP (MD can) (RB not) (VP (VB be) (VP (VBN optimised) (ADVP (RB directly)) (S (VP (VBG using) (NP (NN gradient) (HYPH -) (NN descent) (NNS methods)))))))) (. .))
(S (PP (IN To) (NP (DT this) (NN end))) (, ,) (NP (PRP we)) (VP (VBP introduce) (NP (NP (DT an) (NN objective)) (SBAR (WHNP (WDT that)) (S (VP (VBZ optimises) (PP (RB instead) (NP (NP (NP (DT a) (VBN smoothed) (NN approximation)) (PP (IN of) (NP (NN AP)))) (, ,) (VP (VBN coined) (S (ADJP (JJ Smooth) (HYPH -) (NN AP))))))))))) (. .))
(S (S (NP (ADJP (JJ Smooth) (HYPH -) (NN AP))) (VP (VP (VBZ is) (NP (DT a) (NN plug) (HYPH -))) (CC and))) (HYPH -) (S (VP (VB play) (NP (NP (NN objective) (NN function)) (SBAR (WHNP (WDT that)) (S (VP (VBZ allows) (PP (IN for))))))) (NP (NP (NML (NML (NN end)) (HYPH -) (PP (IN to) (HYPH -) (NP (NN end)))) (NN training)) (PP (IN of) (NP (NP (JJ deep) (NNS networks)) (PP (IN with) (NP (DT a) (ADJP (JJ simple) (CC and) (JJ elegant)) (NN implementation))))))) (. .))
(S (NP (PRP We)) (ADVP (RB also)) (VP (VBP present) (NP (NP (DT an) (NN analysis)) (PP (IN for) (SBAR (WHADVP (WRB why)) (S (S (ADVP (RB directly)) (VP (VBG optimising) (NP (DT the) (VBG ranking)) (PP (VBN based) (NP (NP (JJ metric)) (PP (IN of) (NP (NN AP))))))) (VP (VBZ offers) (NP (NP (NNS benefits)) (PP (IN over) (NP (JJ other) (JJ deep) (JJ metric) (NN learning) (NNS losses)))))))))) (. .))
(S (NP (PRP We)) (VP (VBP apply) (ADJP (JJ Smooth) (HYPH -) (NN AP)) (PP (IN to) (NP (JJ standard) (NN retrieval) (NNS benchmarks))) (: :) (NP (NP (NP (NML (NNP Stanford) (NNP Online)) (NNS products)) (CC and) (NP (NN VehicleID))) (, ,) (CC and) (NP (S (ADVP (RB also)) (VP (VB evaluate) (PP (IN on) (NP (NML (JJR larger) (HYPH -) (NN scale)) (NNS datasets))))) (: :) (NP (NP (NP (NNP INaturalist)) (PP (IN for) (NP (ADJP (JJ fine) (HYPH -) (JJ grained)) (NN category) (NN retrieval)))) (, ,) (CC and) (NP (NP (NN VGGFace2)) (CC and) (NP (NP (NN IJB) (HYPH -) (NN C)) (PP (IN for) (NP (NN face) (NN retrieval))))))))) (. .))
(S (PP (IN In) (NP (DT all) (NNS cases))) (, ,) (NP (PRP we)) (VP (VBP improve) (NP (NP (DT the) (NN performance)) (PP (IN over) (NP (DT the) (NML (NML (NN state)) (HYPH -) (PP (IN of) (HYPH -) (NP (DT the) (HYPH -) (NN art))))))) (, ,) (ADVP (RB especially)) (PP (IN for) (NP (NML (JJR larger) (HYPH -) (NN scale)) (NNS datasets))) (, ,) (S (ADVP (RB thus)) (VP (VBG demonstrating) (NP (NP (DT the) (NN effectiveness) (CC and) (NN scalability)) (PP (IN of) (NP (NP (ADJP (JJ Smooth) (HYPH -) (NN AP))) (PP (IN to) (NP (NML (JJ real) (HYPH -) (NN world)) (NNS scenarios))))))))) (. .))
