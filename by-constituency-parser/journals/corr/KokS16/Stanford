(S (PP (IN In) (NP (DT this) (NN work))) (NP (PRP we)) (VP (VBP present) (NP (DT a) (JJ practical) (NN algorithm)) (PP (IN for) (S (VP (VBG calibrating) (NP (DT a) (NN magnetometer)) (PP (PP (IN for) (NP (NP (DT the) (NN presence)) (PP (IN of) (NP (JJ magnetic) (NNS disturbances))))) (CC and) (PP (IN for) (NP (NN magnetometer) (NN sensor) (NNS errors)))))))) (. .))
(S (S (VP (TO To) (VP (VB allow) (PP (IN for) (S (VP (VBG combining) (NP (DT the) (NN magnetometer) (NNS measurements)) (PP (IN with) (NP (NP (JJ inertial) (NNS measurements)) (PP (IN for) (NP (NN orientation) (NN estimation))))))))))) (, ,) (NP (DT the) (NN algorithm)) (ADVP (RB also)) (VP (VBZ corrects) (PP (IN for) (NP (NP (NN misalignment)) (PP (IN between) (NP (NP (DT the) (NN magnetometer)) (CC and) (NP (DT the) (JJ inertial) (NN sensor) (NNS axes))))))) (. .))
(S (S (NP (DT The) (NN calibration) (NN algorithm)) (VP (VBZ is) (VP (VBN formulated) (PP (IN as) (NP (DT the) (NN solution))) (PP (IN to) (NP (DT a) (JJ maximum) (NN likelihood) (NN problem)))))) (CC and) (S (NP (DT the) (NNS computations)) (VP (VBP are) (VP (VBN performed) (ADVP (RB offline))))) (. .))
(S (NP (DT The) (NN algorithm)) (VP (VBZ is) (VP (VBN shown) (S (VP (TO to) (VP (VB give) (NP (NP (JJ good) (NNS results)) (VP (VBG using) (NP (NNS data)) (PP (IN from) (NP (CD two))))) (NP (JJ different) (ADJP (RB commercially) (JJ available)) (NN sensor) (NNS units))))))) (. .))
(S (S (VP (VBG Using) (NP (DT the) (VBN calibrated) (NN magnetometer) (NNS measurements)) (PP (IN in) (NP (NN combination))) (PP (IN with) (NP (DT the) (JJ inertial) (NNS sensors))) (S (VP (TO to) (VP (VB determine) (NP (NP (DT the) (NN sensor) (POS 's)) (NN orientation))))))) (VP (VBZ is) (VP (VBN shown) (S (VP (TO to) (VP (VB lead) (PP (IN to) (S (NP (RB significantly) (VBN improved)) (VP (VBG heading) (NP (NNS estimates)))))))))) (. .))
