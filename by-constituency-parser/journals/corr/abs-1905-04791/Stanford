(S (NP (JJ Computational) (NN color) (NN constancy)) (VP (VP (VBZ refers) (PP (IN to) (NP (NP (DT the) (NN estimation)) (PP (IN of) (NP (DT the) (NN scene) (NN illumination)))))) (CC and) (VP (VBZ makes) (S (NP (DT the) (VBN perceived) (NN color)) (ADJP (RB relatively) (JJ stable) (PP (IN under) (NP (VBG varying) (NN illumination))))))) (. .))
(S (PP (IN In) (NP (DT the) (JJ past) (JJ few) (NNS years))) (, ,) (NP (NP (JJ deep) (JJ Convolutional) (JJ Neural) (NNS Networks)) (-LRB- -LRB-) (NP (NNS CNNs)) (-RRB- -RRB-)) (VP (VBP have) (VP (VBN delivered) (NP (JJ superior) (NN performance)) (PP (IN in) (NP (JJ illuminant) (NN estimation))))) (. .))
(S (NP (JJ Several) (JJ representative) (NNS methods)) (VP (VBP formulate) (NP (PRP it)) (PP (IN as) (NP (DT a) (JJ multi-label) (NN prediction) (NN problem))) (PP (IN by) (S (VP (VBG learning) (NP (NP (DT the) (JJ local) (NN appearance)) (PP (IN of) (NP (NP (NN image) (NNS patches)) (VP (VBG using) (NP (NNS CNNs)))))))))) (. .))
(S (ADVP (RB However)) (, ,) (NP (DT these) (NNS approaches)) (ADVP (RB inevitably)) (VP (VBP make) (NP (JJ incorrect) (NNS estimations)) (PP (IN for) (NP (NP (DT the) (JJ ambiguous) (NNS patches)) (VP (VBN affected) (PP (IN by) (NP (PRP$ their) (NN neighborhood) (NNS contexts))))))) (. .))
(S (NP (JJ Inaccurate) (JJ local) (NNS estimates)) (VP (VBP are) (ADJP (JJ likely) (S (VP (TO to) (VP (VB bring) (PRT (RP in)) (NP (JJ degraded) (NN performance)) (SBAR (WHADVP (WRB when)) (S (VP (VBG combining) (PP (IN into) (NP (DT a) (JJ global) (NN prediction))))))))))) (. .))
(S (S (VP (TO To) (VP (VB address) (NP (DT the) (JJ above) (NNS issues))))) (, ,) (NP (PRP we)) (VP (VBP propose) (NP (NP (DT a) (ADJP (NP (NP (JJ contextual) (JJ deep) (NN network)) (PP (IN for) (NP (NN patch)))) (HYPH -) (VBN based)) (JJ illuminant) (NN estimation)) (VP (VBN equipped) (PP (IN with) (NP (NN refinement)))))) (. .))
(FRAG (FRAG (ADVP (RB First)) (, ,) (NP (NP (DT the) (JJ contextual) (NN net)) (PP (IN with) (NP (NML (S (NP (DT a) (NN center)) (HYPH -) (VP (VB surround) (NP (NN architecture) (NNS extracts)) (PP (NP (JJ local) (JJ contextual) (NNS features)) (IN from))))) (NN image) (NNS patches))))) (, ,) (CC and) (S (VP (VBZ generates) (SBAR (S (NP (NP (JJ initial) (JJ illuminant) (NNS estimates)) (CC and) (NP (DT the) (VBG corresponding) (NN color))) (VP (VBD corrected) (NP (NNS patches))))))) (. .))
(S (NP (DT The) (NNS patches)) (VP (VBP are) (VP (VBN sampled) (PP (VBN based) (PP (IN on) (NP (NP (DT the) (NN observation)) (SBAR (IN that) (S (NP (NP (NNS pixels)) (PP (IN with) (NP (JJ large) (NN color) (NNS differences)))) (VP (VBP describe) (NP (DT the) (NN illumination)) (ADVP (RB well)))))))))) (. .))
(S (ADVP (RB Then)) (, ,) (NP (DT the) (NN refinement) (JJ net)) (VP (VBZ integrates) (NP (DT the) (NN input) (NNS patches)) (PP (IN with) (NP (NP (DT the) (VBN corrected) (NNS patches)) (PP (IN in) (NP (NP (NN conjunction)) (PP (IN with) (NP (NP (DT the) (NN use)) (PP (IN of) (NP (JJ intermediate) (NNS features))))))) (S (VP (TO to) (VP (VB improve) (NP (DT the) (NN performance)))))))) (. .))
(S (S (VP (TO To) (VP (VB train) (NP (PDT such) (DT a) (NN network)) (PP (IN with) (NP (JJ numerous) (NNS parameters)))))) (, ,) (NP (PRP we)) (VP (VBP propose) (SBAR (S (NP (NP (DT a) (JJ stage-wise) (NN training) (NN strategy)) (, ,) (SBAR (WHPP (IN in) (WHNP (WDT which))) (S (NP (NP (DT the) (NNS features)) (CC and) (NP (NP (DT the) (VBN predicted) (NN illuminant)) (PP (IN from) (NP (JJ previous) (NNS stages))))) (VP (VBP are) (VP (VBN provided) (PP (IN to) (NP (NP (DT the) (JJ next) (NN learning) (NN stage)) (PP (IN with) (NP (ADJP (NP (JJR more)) (JJR finer)) (NNS estimates)))))))))) (VP (VBD recovered))))) (. .))
(S (NP (NNS Experiments)) (VP (VBP show) (SBAR (IN that) (S (NP (PRP$ our) (NN approach)) (VP (VBZ obtains) (NP (JJ competitive) (NN performance)) (PP (IN on) (NP (CD two) (JJ illuminant) (NN estimation) (NNS benchmarks))))))) (. .))
