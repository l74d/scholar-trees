(S (NP (NML (NML (NNP Shadow) (NN detection)) (CC and) (NML (NN shadow))) (NN removal)) (VP (VBP are) (NP (ADJP (JJ fundamental) (CC and) (JJ challenging)) (NNS tasks)) (, ,) (S (VP (VBG requiring) (NP (NP (DT an) (NN understanding)) (PP (IN of) (NP (DT the) (JJ global) (NN image) (NNS semantics))))))) (. .))
(S (NP (DT This) (NN paper)) (VP (VBZ presents) (NP (NP (DT a) (JJ novel) (NML (JJ deep) (JJ neural) (NN network)) (NN design)) (PP (IN for) (NP (NN shadow) (NN detection) (CC and) (NN removal)))) (PP (IN by) (S (VP (VBG analyzing) (NP (DT the) (JJ spatial) (NN image) (NN context)) (PP (IN in) (NP (ADJP (NP (DT a) (NN direction)) (HYPH -) (JJ aware)) (NN manner))))))) (. .))
(S (S (VP (TO To) (VP (VB achieve) (NP (DT this))))) (, ,) (NP (PRP we)) (ADVP (RB first)) (VP (VB formulate) (NP (NP (DT the) (ADJP (NP (NN direction)) (HYPH -) (JJ aware)) (NN attention) (NN mechanism)) (PP (IN in) (NP (DT a) (ADJP (JJ spatial) (JJ recurrent)) (JJ neural) (NN network) (PRN (-LRB- -LRB-) (NP (NN RNN)) (-RRB- -RRB-))))) (PP (IN by) (S (VP (VBG introducing) (NP (NN attention) (NNS weights)) (SBAR (WHADVP (WRB when)) (S (VP (VBG aggregating) (NP (JJ spatial) (NN context) (NNS features)) (PP (IN in) (NP (DT the) (NN RNN)))))))))) (. .))
(S (PP (IN By) (S (VP (VBG learning) (NP (DT these) (NNS weights)) (PP (IN through) (NP (NN training)))))) (, ,) (NP (PRP we)) (VP (MD can) (VP (VB recover) (NP (NN direction) (HYPH -) (ADJP (JJ aware) (JJ spatial)) (NN context) (PRN (-LRB- -LRB-) (NP (NN DSC)) (-RRB- -RRB-))) (PP (IN for) (S (VP (VBG detecting) (CC and) (VBG removing) (NP (NNS shadows))))))) (. .))
(S (NP (DT This) (NN design)) (VP (VBZ is) (VP (VP (VBN developed) (PP (IN into) (NP (DT the) (NNP DSC) (NN module)))) (CC and) (VP (VBN embedded) (PP (IN in) (NP (DT a) (JJ convolutional) (JJ neural) (NN network) (PRN (-LRB- -LRB-) (NP (NNP CNN)) (-RRB- -RRB-)))) (S (VP (TO to) (VP (VB learn) (SBAR (S (NP (DT the) (NN DSC)) (VP (VBZ features) (PP (IN at) (NP (JJ different) (NNS levels)))))))))))) (. .))
(S (ADVP (RB Moreover)) (, ,) (NP (PRP we)) (VP (VBP design) (NP (DT a) (JJ weighted) (NN cross) (NN entropy) (NN loss)) (S (VP (TO to) (VP (VB make) (NP (JJ effective) (DT the) (NN training)) (PP (IN for) (NP (NP (NN shadow) (NN detection)) (CC and) (NP (JJ further)))) (S (VP (VB adopt) (NP (NP (DT the) (NN network)) (PP (IN for) (NP (NN shadow) (NN removal)))) (PP (IN by) (S (VP (VP (VBG using) (NP (DT a) (JJ Euclidean) (NN loss) (NN function))) (CC and) (VP (VBG formulating) (NP (DT a) (NML (NN color) (NN transfer)) (NN function)) (S (VP (TO to) (VP (VB address) (NP (DT the) (NML (NN color) (CC and) (NN luminosity)) (NNS inconsistencies)) (PP (IN in) (NP (DT the) (NN training) (NNS pairs)))))))))))))))) (. .))
(S (NP (PRP We)) (VP (VP (VBD employed) (NP (NP (CD two) (NN shadow) (NN detection) (NN benchmark) (NNS datasets)) (CC and) (NP (CD two) (NN shadow) (NN removal) (NN benchmark) (NNS datasets)))) (, ,) (CC and) (VP (VBD performed) (NP (JJ various) (NNS experiments)) (S (VP (TO to) (VP (VB evaluate) (NP (PRP$ our) (NN method))))))) (. .))
(S (NP (JJ Experimental) (NNS results)) (VP (VBP show) (SBAR (IN that) (S (NP (PRP$ our) (NN method)) (VP (VBZ performs) (ADVP (RB favorably)) (PP (IN against) (NP (NP (DT the) (ADJP (NN state) (HYPH -) (IN of) (HYPH -) (DT the) (HYPH -) (NN art)) (NNS methods)) (PP (IN for) (NP (NP (DT both) (NN shadow) (NN detection)) (CC and) (NP (NN shadow) (NN removal)))))))))) (. .))
