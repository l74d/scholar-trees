(S (NP (NP (NNP Shadow) (NN detection)) (CC and) (NP (NN shadow) (NN removal))) (VP (VBP are) (NP (ADJP (JJ fundamental) (CC and) (JJ challenging)) (NNS tasks)) (, ,) (S (VP (VBG requiring) (NP (NP (DT an) (NN understanding)) (PP (IN of) (NP (DT the) (JJ global) (NN image) (NNS semantics))))))) (. .))
(S (NP (DT This) (NN paper)) (VP (VBZ presents) (NP (NP (DT a) (JJ novel) (JJ deep) (JJ neural) (NN network) (NN design)) (PP (PP (IN for) (NP (JJ shadow) (NN detection) (CC and) (NN removal))) (PP (IN by) (S (VP (VBG analyzing) (NP (DT the) (JJ spatial) (NN image) (NN context)) (PP (IN in) (NP (DT a) (JJ direction-aware) (NN manner))))))))) (. .))
(S (S (VP (TO To) (VP (VB achieve) (NP (DT this))))) (, ,) (NP (PRP we)) (ADVP (RB first)) (VP (VB formulate) (NP (DT the) (JJ direction-aware) (NN attention) (NN mechanism)) (PP (IN in) (NP (NP (DT a) (JJ spatial) (NN recurrent) (JJ neural) (NN network)) (PRN (-LRB- -LRB-) (NP (NNP RNN)) (-RRB- -RRB-)))) (PP (IN by) (S (VP (VBG introducing) (NP (NN attention) (NNS weights)) (SBAR (WHADVP (WRB when)) (S (VP (VBG aggregating) (NP (JJ spatial) (NN context) (NNS features)) (PP (IN in) (NP (DT the) (NNP RNN)))))))))) (. .))
(S (PP (IN By) (S (VP (VBG learning) (NP (DT these) (NNS weights)) (PP (IN through) (NP (NN training)))))) (, ,) (NP (PRP we)) (VP (MD can) (VP (VB recover) (NP (NP (JJ direction-aware) (JJ spatial) (NN context)) (PRN (-LRB- -LRB-) (NP (NNP DSC)) (-RRB- -RRB-)) (PP (IN for) (S (VP (VBG detecting) (CC and) (VBG removing) (NP (NNS shadows)))))))) (. .))
(S (NP (DT This) (NN design)) (VP (VBZ is) (VP (VP (VBN developed) (PP (IN into) (NP (DT the) (NNP DSC) (NN module)))) (CC and) (VP (VBN embedded) (PP (IN in) (NP (NP (DT a) (JJ convolutional) (JJ neural) (NN network)) (PRN (-LRB- -LRB-) (NP (NNP CNN)) (-RRB- -RRB-)))) (S (VP (TO to) (VP (VB learn) (NP (DT the) (NNP DSC) (NNS features)) (PP (IN at) (NP (JJ different) (NNS levels))))))))) (. .))
(S (ADVP (RB Moreover)) (, ,) (NP (PRP we)) (VP (VP (VBP design) (NP (DT a) (JJ weighted) (NN cross) (NN entropy) (NN loss)) (S (VP (TO to) (VP (VB make) (S (ADJP (JJ effective)) (NP (NP (DT the) (NN training)) (PP (IN for) (NP (JJ shadow) (NN detection))))))))) (CC and) (VP (ADVP (JJ further)) (VB adopt) (NP (DT the) (NN network)) (PP (IN for) (NP (NN shadow) (NN removal))) (PP (IN by) (S (VP (VP (VBG using) (NP (DT a) (JJ Euclidean) (NN loss) (NN function))) (CC and) (VP (VBG formulating) (NP (DT a) (NN color) (NN transfer) (NN function)) (S (VP (TO to) (VP (VB address) (NP (NP (DT the) (NN color) (CC and) (NN luminosity) (NNS inconsistencies)) (PP (IN in) (NP (DT the) (NN training) (NNS pairs))))))))))))) (. .))
(S (NP (PRP We)) (VP (VP (VBD employed) (NP (NP (CD two) (JJ shadow) (NN detection) (NN benchmark) (NNS datasets)) (CC and) (NP (CD two) (NN shadow) (NN removal) (NN benchmark) (NNS datasets)))) (, ,) (CC and) (VP (VBD performed) (NP (JJ various) (NNS experiments)) (S (VP (TO to) (VP (VB evaluate) (NP (PRP$ our) (NN method))))))) (. .))
(S (NP (JJ Experimental) (NNS results)) (VP (VBP show) (SBAR (IN that) (S (NP (PRP$ our) (NN method)) (VP (VBZ performs) (ADVP (RB favorably)) (PP (IN against) (NP (NP (DT the) (JJ state-of-the-art) (NNS methods)) (PP (IN for) (NP (DT both) (NP (JJ shadow) (NN detection)) (CC and) (NP (NN shadow) (NN removal)))))))))) (. .))
