(S (S (VP (VBG Optimising) (NP (NP (DT a) (JJ ranking-based) (JJ metric)) (, ,) (PP (JJ such) (IN as) (NP (NP (JJ Average) (NNP Precision)) (PRN (-LRB- -LRB-) (NP (NNP AP)) (-RRB- -RRB-)) (, ,)))))) (VP (VBZ is) (ADJP (RB notoriously) (VBG challenging)) (PP (JJ due) (TO to) (NP (DT the) (NN fact) (SBAR (IN that) (S (NP (PRP it)) (VP (VP (VBZ is) (ADJP (JJ non-differentiable))) (, ,) (CC and) (VP (ADVP (RB hence)) (VP (MD can) (RB not) (VP (VB be) (VP (VBN optimised) (ADVP (RB directly)) (S (VP (VBG using) (NP (JJ gradient-descent) (NNS methods)))))))))))))) (. .))
(S (PP (TO To) (NP (DT this) (NN end))) (, ,) (NP (PRP we)) (VP (VBP introduce) (NP (NP (DT an) (NN objective)) (SBAR (WHNP (WDT that)) (S (VP (VBZ optimises) (ADVP (RB instead)) (NP (NP (DT a) (JJ smoothed) (NN approximation)) (PP (IN of) (NP (NNP AP))) (, ,) (VP (VBD coined) (S (NP (NNP Smooth-AP)))))))))) (. .))
(S (NP (NNP Smooth-AP)) (VP (VBZ is) (NP (NP (DT a) (JJ plug-and-play) (JJ objective) (NN function)) (SBAR (WHNP (WDT that)) (S (VP (VBZ allows) (PP (IN for) (NP (NP (JJ end-to-end) (NN training)) (PP (IN of) (NP (JJ deep) (NNS networks))))) (PP (IN with) (NP (DT a) (ADJP (JJ simple) (CC and) (JJ elegant)) (NN implementation)))))))) (. .))
(S (NP (PRP We)) (ADVP (RB also)) (VP (VBD present) (NP (NP (DT an) (NN analysis)) (PP (IN for) (SBAR (WHADVP (WRB why)) (S (S (VP (ADVP (RB directly)) (VBG optimising) (NP (NP (DT the) (ADJP (NN ranking) (VBN based)) (JJ metric)) (PP (IN of) (NP (NNP AP)))))) (VP (VBZ offers) (NP (NP (NNS benefits)) (PP (IN over) (NP (JJ other) (JJ deep) (JJ metric) (NN learning) (NNS losses)))))))))) (. .))
(S (NP (PRP We)) (VP (VP (VBP apply) (NP (JJ Smooth-AP)) (PP (TO to) (NP (NP (VB standard) (NN retrieval) (NNS benchmarks)) (: :) (NP (NP (NNP Stanford) (NNP Online) (NNS products)) (CC and) (NP (NNP VehicleID)))))) (, ,) (CC and) (ADVP (RB also)) (VP (VB evaluate) (PP (IN on) (NP (NP (JJ larger-scale) (NNS datasets)) (: :) (NP (NP (NP (NN INaturalist)) (PP (IN for) (NP (JJ fine-grained) (NN category) (NN retrieval)))) (, ,) (CC and) (NP (NP (NP (NNP VGGFace2)) (CC and) (NP (NNP IJB-C))) (PP (IN for) (NP (NN face) (NN retrieval))))))))) (. .))
(S (PP (IN In) (NP (DT all) (NNS cases))) (, ,) (NP (PRP we)) (VP (VBP improve) (NP (DT the) (NN performance)) (PP (IN over) (NP (DT the) (JJ state-of-the-art))) (, ,) (PP (ADVP (RB especially)) (IN for) (NP (JJ larger-scale) (NNS datasets))) (, ,) (S (ADVP (RB thus)) (VP (VBG demonstrating) (NP (NP (DT the) (NN effectiveness) (CC and) (NN scalability)) (PP (IN of) (NP (NNP Smooth-AP))) (PP (TO to) (NP (VB real-world) (NNS scenarios))))))) (. .))
