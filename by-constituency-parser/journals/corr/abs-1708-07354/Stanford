(S (PRN (S (NP (PRP We)) (VP (VBP prove) (SBAR (IN that) (S (NP (NP (DT the) (NML (NML (NNP Weisfeiler) (HYPH -) (NNP Leman)) (-LRB- -LRB-) (NML (NP (NNP WL))) (-RRB- -RRB-)) (NN dimension)) (PP (IN of) (NP (NP (DT the) (NN class)) (PP (IN of) (NP (DT all) (JJ finite) (NN planar) (NNS graphs)))))) (VP (VBZ is) (ADVP (IN at) (RBS most)))))))) (LST (LS 3)) (. .))
(S (PP (IN In) (ADJP (JJ particular))) (, ,) (NP (DT every) (NN finite) (JJ planar) (NN graph)) (VP (VBZ is) (ADJP (JJ definable) (PP (IN in) (NP (NML (JJ first) (HYPH -) (NN order)) (NN logic)))) (PP (IN with) (S (VP (VBG counting) (S (VP (VBG using) (NP (QP (ADVP (IN at) (RBS most)) (CD 4)) (NNS variables)))))))) (. .))
(S (NP (NP (DT The) (ADJP (RB previously) (RB best) (VBN known)) (JJ upper) (NNS bounds)) (PP (IN for) (NP (NP (DT the) (NN dimension) (CC and) (NN number)) (PP (IN of) (NP (NNS variables)))))) (VP (VBD were) (NP (QP (CD 14) (CC and) (CD 15))) (, ,) (ADVP (RB respectively))) (. .))
(S (ADVP (RB First)) (NP (PRP we)) (VP (VBP show) (SBAR (IN that) (, ,) (S (PP (IN for) (NP (NP (NN dimension) (CD 3)) (CC and) (NP (JJR higher)))) (, ,) (NP (DT the) (NNP WL) (HYPH -) (NN algorithm)) (ADVP (RB correctly)) (VP (VBZ tests) (NP (NP (NN isomorphism)) (PP (IN of) (NP (NP (NNS graphs)) (PP (IN in) (NP (NP (DT a) (ADJP (JJ minor) (HYPH -) (JJ closed)) (NN class)) (SBAR (WHADVP (WRB whenever)) (S (NP (PRP it)) (VP (VBZ determines) (NP (NP (DT the) (ADJP (NP (NP (NNS orbits)) (PP (IN of) (NP (NP (DT the) (NN automorphism) (NN group)) (PP (IN of) (NP (DT any) (NN arc)))))) (HYPH -) (VBN colored)) (ADJP (CD 3) (HYPH -) (JJ connected)) (NN graph)) (VP (VBG belonging) (PP (IN to) (NP (DT this) (NN class))))))))))))))))) (. .))
(S (ADVP (RB Then)) (NP (PRP we)) (VP (VBP prove) (SBAR (IN that) (, ,) (S (PP (RB apart) (PP (IN from) (NP (NP (JJ several) (JJ exceptional) (NNS graphs)) (-LRB- -LRB-) (SBAR (WHNP (WDT which)) (S (VP (VBP have) (NP (NP (NNP WL)) (PP (HYPH -) (NP (NN dimension)))))))))) (NP (ADVP (IN at) (RBS most)) (NP (LST (LS 2) (-RRB- -RRB-)) (, ,) (NP (NP (DT the) (NN individualization)) (PP (IN of) (NP (NP (CD two) (ADJP (RB correctly) (VBN chosen)) (NNS vertices)) (PP (IN of) (NP (NP (DT a) (JJ colored) (ADJP (CD 3) (HYPH -) (VBN connected)) (JJ planar) (NN graph)) (VP (VBN followed) (PP (IN by) (NP (NP (DT the) (ADJP (CD 1) (HYPH -) (JJ dimensional)) (NNP WL)) (HYPH -) (NP (NN algorithm)))))))))))) (VP (VBZ produces) (NP (DT the) (JJ discrete) (NN vertex) (NN partition)))))) (. .))
(S (NP (DT This)) (VP (VBZ implies) (SBAR (IN that) (S (NP (DT the) (NML (ADJP (NML (CD 3)) (HYPH -) (JJ dimensional)) (NNP WL)) (HYPH -) (NN algorithm)) (VP (VBZ determines) (NP (NP (DT the) (NNS orbits)) (PP (IN of) (NP (DT a) (JJ colored) (ADJP (CD 3) (HYPH -) (VBN connected)) (JJ planar) (NN graph)))))))) (. .))
(S (PP (IN As) (NP (NP (DT a) (NN byproduct)) (PP (IN of) (NP (DT the) (NN proof))))) (, ,) (NP (PRP we)) (VP (VBP get) (NP (NP (DT a) (NN classification)) (PP (IN of) (NP (DT the) (ADJP (CD 3) (HYPH -) (VBN connected)) (NN planar) (NNS graphs)))) (PP (IN with) (S (VP (VBG fixing) (NP (NN number) (CD 3)))))) (. .))
