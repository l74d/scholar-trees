(S (NP (PRP We)) (VP (VBP prove) (SBAR (IN that) (S (NP (NP (DT the) (NNP Weisfeiler-Leman) (PRN (-LRB- -LRB-) (NNP WL) (-RRB- -RRB-)) (NN dimension)) (PP (IN of) (NP (NP (DT the) (NN class)) (PP (IN of) (NP (DT all) (JJ finite) (NN planar) (NN graphs)))))) (VP (VBZ is) (NP (ADVP (IN at) (JJS most)) (CD 3)))))) (. .))
(S (PP (IN In) (NP (JJ particular))) (, ,) (NP (DT every) (NN finite) (NN planar) (NN graph)) (VP (VBZ is) (ADJP (JJ definable)) (PP (IN in) (NP (JJ first-order) (NN logic))) (PP (IN with) (NP (VBG counting))) (S (VP (VBG using) (NP (QP (IN at) (JJS most) (CD 4)) (NNS variables))))) (. .))
(S (NP (NP (DT The) (ADJP (RB previously) (JJS best) (VBN known)) (JJ upper) (NNS bounds)) (PP (IN for) (NP (NP (DT the) (NN dimension) (CC and) (NN number)) (PP (IN of) (NP (NNS variables)))))) (VP (VBD were) (NP (NP (CD 14) (CC and) (CD 15)) (, ,) (ADVP (RB respectively)))) (. .))
(S (ADVP (RB First)) (NP (PRP we)) (VP (VBP show) (SBAR (IN that) (, ,) (S (PP (IN for) (NP (NN dimension) (CD 3) (QP (CC and) (JJR higher)))) (, ,) (NP (DT the) (NNP WL-algorithm)) (VP (ADVP (NN correctly)) (VBZ tests) (NP (NP (NN isomorphism)) (PP (IN of) (NP (NP (NN graphs)) (PP (IN in) (NP (DT a) (JJ minor-closed) (NN class)))))) (SBAR (WHADVP (WRB whenever)) (S (NP (PRP it)) (VP (VBZ determines) (NP (NP (DT the) (NNS orbits)) (PP (IN of) (NP (NP (DT the) (NN automorphism) (NN group)) (PP (IN of) (NP (NP (DT any) (JJ arc-colored) (JJ 3-connected) (NN graph)) (VP (VBG belonging) (PP (TO to) (NP (DT this) (NN class)))))))))))))))) (. .))
(S (ADVP (RB Then)) (NP (PRP we)) (VP (VBP prove) (SBAR (IN that) (, ,) (S (ADVP (RB apart) (PP (IN from) (NP (NP (JJ several) (JJ exceptional) (NN graphs)) (PRN (-LRB- -LRB-) (SBAR (WHNP (WDT which)) (S (VP (VBP have) (NP (NNP WL-dimension)) (NP (ADVP (IN at) (JJS most)) (CD 2))))) (-RRB- -RRB-))))) (, ,) (NP (NP (DT the) (NN individualization)) (PP (IN of) (NP (NP (CD two) (ADJP (RB correctly) (VBN chosen)) (NNS vertices)) (PP (IN of) (NP (DT a) (JJ colored) (JJ 3-connected) (NN planar) (NN graph))))) (VP (VBN followed) (PP (IN by) (NP (DT the) (JJ 1-dimensional) (JJ WL-algorithm))))) (VP (VBZ produces) (NP (DT the) (JJ discrete) (NN vertex) (NN partition)))))) (. .))
(S (NP (DT This)) (VP (VBZ implies) (SBAR (IN that) (S (NP (DT the) (JJ 3-dimensional) (NNP WL-algorithm)) (VP (VBZ determines) (NP (NP (DT the) (NNS orbits)) (PP (IN of) (NP (DT a) (JJ colored) (JJ 3-connected) (NN planar) (NN graph)))))))) (. .))
(S (PP (IN As) (NP (NP (DT a) (NN byproduct)) (PP (IN of) (NP (DT the) (NN proof))))) (, ,) (NP (PRP we)) (VP (VBP get) (NP (NP (DT a) (NN classification)) (PP (IN of) (NP (DT the) (JJ 3-connected) (NN planar) (NN graphs))) (PP (IN with) (S (VP (VBG fixing) (NX (NN number) (CD 3))))))) (. .))
